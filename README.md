# CRM-lite 

## Описание проекта: 
Проект представляет собой систему управления складом, поставками и продажами для компании. Пользователи могут регистрироваться, создавать компании, управлять складами, поставками, товарами и продажами. Система реализована на Django с использованием REST API (JWT аутентификация).  


---

## Содержание

- [Технологии](#технологии)  
- [Модели и таблицы](#модели-и-таблицы)  
- [Основные функции](#основные-функции)  
- [Дополнительный функционал](#дополнительный-функционал)  
- [Установка и запуск](#установка-и-запуск)  

---

## Технологии

- Python 3.14  
- Django 5.2.8  
- Django REST Framework 3.16.1  
- djangorestframework-simplejwt 5.5.1 
- drf-spectacular 0.29.0 
- SQLite 

---

## Модели и таблицы

В проекте используется **9 основных таблиц**:

- **User** - расширенная модель пользователя (AbstractUser) с полями `email` (уникальный), `is_company_owner`, `company` (FK). Может быть владельцем компании или сотрудником.  
- **Company** - компания с полями `name`, `inn` (уникальный), `owner` (FK на User).  
- **Storage** - склад компании (`address`, `company` FK). Привязан к одной компании.  
- **Supplier** - поставщик (`name`, `INN`, `company` FK).  
- **Product** - товар (`title`, `quantity`, `purchase_price`, `sale_price`, `storage` FK).  
- **Supply** - поставка товаров (`supplier` FK, `delivery_date`). Связь с Product через **SupplyProduct**.  
- **Sale** - продажа (`buyer_name`, `company` FK, `discount`). Связь с Product через **ProductSale**.  


**Промежуточные таблицы:**

- **SupplyProduct** - связь Supply - Product  
- **ProductSale** - связь Sale - Product

---

## Основные функции

### Регистрация и аутентификация
- Регистрация пользователей и вход через JWT  
- Расширенная модель User с поддержкой роли владельца компании  
- Админка Django  

### Управление компаниями
- Создание компании 
- Просмотр и редактирование компании 
- Прикрепление сотрудников к компании 

### Склад
- Создание, редактирование, удаление склада 
- Просмотр склада всеми пользователями компании  

### Поставки и товары
- Добавление поставщиков, поставок и товаров  
- Товары добавляются на склад только через поставку  
- Поддержка связи Supply - Product  
- Автоматическое увеличение `quantity` товара при поставке  

### Продажи
- Создание продаж с проверкой наличия товаров на складе  
- Уменьшение количества товара при продаже  
- Отмена/удаление продажи - восстановление количества товара  
- Связь Sale - Product через ProductSale  

---

## Дополнительный функционал

- **Аналитика продаж**:  
  - Общая/чистая прибыль по дням, неделям, месяцам, году или произвольный период  
  - ТОП продаваемых товаров  
  - ТОП товаров с наибольшей чистой прибылью  

---

## Установка и запуск

```bash
git clone <репозиторий>
cd project

# Зависимости и виртуальное окружение
poetry install
poetry shell

# Запуск
python manage.py makemigrations
python manage.py migrate
python manage.py createsuperuser
python manage.py runserver
